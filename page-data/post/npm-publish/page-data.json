{"componentChunkName":"component---src-templates-post-tsx","path":"/post/npm-publish/","result":{"data":{"markdownRemark":{"frontmatter":{"title":"npm 라이브러리 개발부터 배포까지","slug":"npm-publish","tags":["JavaScript"],"date":"2025-01-06 02:14:00"},"html":"<p><code class=\"language-text\">pnpm</code> + <code class=\"language-text\">TypeScript</code> 환경에서 React 라이브러리를 개발하고 배포까지 하는 과정</p>\n<p><code class=\"language-text\">부족한 내용이 많아 수정 중인 글입니다.</code></p>\n<h1 id=\"프로젝트-만들기\" style=\"position:relative;\">프로젝트 만들기<a href=\"#%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EB%A7%8C%EB%93%A4%EA%B8%B0\" aria-label=\"프로젝트 만들기 permalink\" class=\"anchor after\"><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" width=\"1rem\" stroke-width=\"1.5\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244\" /></svg></a></h1>\n<p>라이브러리 개발에 필요한 의존성을 추가하여 프로젝트를 구성한다.</p>\n<p>주의할 점은 개발 환경에만 필요한 패키지는 devDependencies에 추가해야 배포할 때 불필요한 의존성을 쉽게 제거할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">pnpm</span> init\n$ <span class=\"token function\">pnpm</span> <span class=\"token function\">add</span> react react-dom\n$ <span class=\"token function\">pnpm</span> <span class=\"token function\">add</span> <span class=\"token parameter variable\">-D</span> eslint typescript @babel/preset-env <span class=\"token punctuation\">..</span>.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<h1 id=\"packagejson-설정\" style=\"position:relative;\">package.json 설정<a href=\"#packagejson-%EC%84%A4%EC%A0%95\" aria-label=\"packagejson 설정 permalink\" class=\"anchor after\"><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" width=\"1rem\" stroke-width=\"1.5\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244\" /></svg></a></h1>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-json line-numbers\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"@kimdw524/react-overlay\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0.0\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"repository\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"git\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://github.com/kimdw524/react-overlay.git\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"keywords\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"license\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"MIT\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"homepage\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://github.com/kimdw524/react-overlay#readme\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"files\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"./dist\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"README.md\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"name\" style=\"position:relative;\">name<a href=\"#name\" aria-label=\"name permalink\" class=\"anchor after\"><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" width=\"1rem\" stroke-width=\"1.5\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244\" /></svg></a></h3>\n<ul>\n<li>\n<p><code class=\"language-text\">@kimdw524/react-overlay</code> 와 같이 scope를 사용할 수 있는데, scope는 자신의 아이디 또는 organization만 사용할 수 있다.</p>\n<p><a href=\"https://docs.npmjs.com/about-scopes\">https://docs.npmjs.com/about-scopes</a></p>\n</li>\n</ul>\n<h3 id=\"version\" style=\"position:relative;\">version<a href=\"#version\" aria-label=\"version permalink\" class=\"anchor after\"><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" width=\"1rem\" stroke-width=\"1.5\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244\" /></svg></a></h3>\n<ul>\n<li>\n<p>version은 <code class=\"language-text\">major</code>. <code class=\"language-text\">minor</code>. <code class=\"language-text\">patch</code> 형태의 3가지 숫자로 구성되어있다.</p>\n</li>\n<li>\n<p>first release시 1.0.0 부터 시작해야 하며, 버그 수정시 <code class=\"language-text\">patch</code> , 새 기능이 추가되면 <code class=\"language-text\">minor</code> , 하위호환성을 깨버리면 <code class=\"language-text\">major</code> 를 1씩 증가시킨다.</p>\n<p><a href=\"https://docs.npmjs.com/about-semantic-versioning\">https://docs.npmjs.com/about-semantic-versioning</a></p>\n</li>\n</ul>\n<h3 id=\"repository-keywords-homepage\" style=\"position:relative;\">repository, keywords, homepage<a href=\"#repository-keywords-homepage\" aria-label=\"repository keywords homepage permalink\" class=\"anchor after\"><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" width=\"1rem\" stroke-width=\"1.5\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244\" /></svg></a></h3>\n<ul>\n<li>\n<p>해당 필드에 입력한 정보를 npmjs.com에서 확인할 수 있다.</p>\n<p><a href=\"https://www.npmjs.com/package/react\">https://www.npmjs.com/package/react</a></p>\n</li>\n</ul>\n<h3 id=\"files\" style=\"position:relative;\">files<a href=\"#files\" aria-label=\"files permalink\" class=\"anchor after\"><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" width=\"1rem\" stroke-width=\"1.5\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244\" /></svg></a></h3>\n<ul>\n<li>npm에 배포할 파일을 명시할 수 있다. <code class=\"language-text\">package.json</code> 은 명시하지 않아도 함께 배포된다.</li>\n<li><code class=\"language-text\">files</code> 프로퍼티가 정의되어 있으면, <code class=\"language-text\">types</code> 프로퍼티는 무시된다.</li>\n</ul>\n<h1 id=\"tsconfigjson-설정\" style=\"position:relative;\">tsconfig.json 설정<a href=\"#tsconfigjson-%EC%84%A4%EC%A0%95\" aria-label=\"tsconfigjson 설정 permalink\" class=\"anchor after\"><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" width=\"1rem\" stroke-width=\"1.5\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244\" /></svg></a></h1>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-json line-numbers\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"declaration\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"jsx\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"react-jsx\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"lib\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"dom\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dom.iterable\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ESNext\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ESNext.AsyncIterable\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"rootDir\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"./src\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"outDir\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"./dist\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"include\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"src/**/*\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"exclude\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"src/tests/**/*\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"declaration\" style=\"position:relative;\">declaration<a href=\"#declaration\" aria-label=\"declaration permalink\" class=\"anchor after\"><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" width=\"1rem\" stroke-width=\"1.5\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244\" /></svg></a></h3>\n<ul>\n<li>\n<p>해당 옵션을 true로 설정해야 빌드할 때 d.ts 파일을 생성한다.</p>\n<p><a href=\"https://www.typescriptlang.org/tsconfig/#declaration\">https://www.typescriptlang.org/tsconfig/#declaration</a></p>\n</li>\n</ul>\n<h1 id=\"로컬-환경에서-테스트\" style=\"position:relative;\">로컬 환경에서 테스트<a href=\"#%EB%A1%9C%EC%BB%AC-%ED%99%98%EA%B2%BD%EC%97%90%EC%84%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"로컬 환경에서 테스트 permalink\" class=\"anchor after\"><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" width=\"1rem\" stroke-width=\"1.5\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244\" /></svg></a></h1>\n<h3 id=\"pnpm-link\" style=\"position:relative;\">pnpm link<a href=\"#pnpm-link\" aria-label=\"pnpm link permalink\" class=\"anchor after\"><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" width=\"1rem\" stroke-width=\"1.5\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244\" /></svg></a></h3>\n<ul>\n<li>\n<p><code class=\"language-text\">pnpm link</code> 를 이용하면 라이브러리를 배포하기 전, 로컬 환경에서 라이브러리를 불러와 테스트 할 수 있다.</p>\n<p><a href=\"https://pnpm.io/ko/cli/link\">https://pnpm.io/ko/cli/link</a></p>\n</li>\n</ul>\n<h1 id=\"배포하기\" style=\"position:relative;\">배포하기<a href=\"#%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0\" aria-label=\"배포하기 permalink\" class=\"anchor after\"><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" width=\"1rem\" stroke-width=\"1.5\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244\" /></svg></a></h1>\n<p><code class=\"language-text\">pnpm build &amp;&amp; pnpm publish --no-git-checks</code> 명령어를 실행하면 npm에 배포할 수 있다.</p>\n<h3 id=\"문제점\" style=\"position:relative;\">문제점?<a href=\"#%EB%AC%B8%EC%A0%9C%EC%A0%90\" aria-label=\"문제점 permalink\" class=\"anchor after\"><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" width=\"1rem\" stroke-width=\"1.5\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244\" /></svg></a></h3>\n<p>배포된 패키지의 <code class=\"language-text\">package.json</code> 을 보면 개발 환경에서만 필요한 의존성들이 추가되어있는 문제가 있다.</p>\n<p>이를 해결하기 위해 <code class=\"language-text\">pnpm pkg delete devDependencies</code> 를 실행하면 <code class=\"language-text\">package.json</code> 에 존재하는 <code class=\"language-text\">devDependencies</code> 를 제거할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">pnpm</span> build <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">pnpm</span> pkg delete devDependencies <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">pnpm</span> publish --no-git-checks</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>"},"prev":{"frontmatter":{"slug":"optimize-ticker","title":"잦은 렌더링이 불가피할 때 최적화하기 (실시간 시세)"}},"next":{"frontmatter":{"slug":"click-recalculate-style","title":"버튼을 클릭하면 즉시 recalculate style이 발생한다."}}},"pageContext":{"id":"9d6cadcd-fa33-5892-9109-deeb1114c99f","prev":"c4fb50e2-c67d-571e-9faa-09e0629d8d57","next":"3f5d63bc-a1a4-5733-9f9d-f642c2b9dc14"}},"staticQueryHashes":["1218423607"],"slicesMap":{}}
{"componentChunkName":"component---src-templates-post-tsx","path":"/post/jsdom-window/","result":{"data":{"markdownRemark":{"frontmatter":{"title":"jest + jsdom 환경에서 window instanceof Window","slug":"jsdom-window","tags":["JavaScript","Jest"],"date":"2025-05-18 00:09:00"},"html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 392px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ef526614e1f7a7dd3ce8c03bedfa039c/0acb4/1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.447852760736193%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA5UlEQVR42p2RWU7EMBBEcwxE7PYaO3YCOItIyCwwDPe/UtETkPhmPp7K6pKeuuUq5YxhHFHKgJQSHp486taBpAQR/ZtqWd9wvX7hcvnEPM+Y+havDEm6T2iMhncOjjHGIOgb+i7ZLhR8WkqZpRZaKbimYTyEEBBSQDK0I/eUnELQzs+bZ+KvqwwpdH2PwCLFwhAiYvwlBBjeXPoA8g2kC7DBIieBtiW+ynO2sA33roG1GlXUCpGHjje8yQ7HIyb+pGVdsW0buueC+mWGLAvqsiKNER/nR5zOGnPp8H44IQ7T3ufs8Q3xhqoIt1xo5wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"window\"\n        title=\"\"\n        src=\"/static/ef526614e1f7a7dd3ce8c03bedfa039c/0acb4/1.png\"\n        srcset=\"/static/ef526614e1f7a7dd3ce8c03bedfa039c/222b7/1.png 163w,\n/static/ef526614e1f7a7dd3ce8c03bedfa039c/ff46a/1.png 325w,\n/static/ef526614e1f7a7dd3ce8c03bedfa039c/0acb4/1.png 392w\"\n        sizes=\"(max-width: 392px) 100vw, 392px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>jsdom 환경에서 정의된 window는 브라우저의 Window 객체가 아니라, 테스트를 목적으로 별도로 구현된 객체입니다.</p>\n<p>만약 아래와 같은 코드가 있을 때, element에 window를 대입하면 조건문을 통과할 수 없습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>element <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Window</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"해결법\" style=\"position:relative;\">해결법<a href=\"#%ED%95%B4%EA%B2%B0%EB%B2%95\" aria-label=\"해결법 permalink\" class=\"anchor after\"><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" width=\"1rem\" stroke-width=\"1.5\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244\" /></svg></a></h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">Object<span class=\"token punctuation\">.</span><span class=\"token function\">setPrototypeOf</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Window</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>window <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Window</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>window 객체의 프로토타입을 Window.prototype으로 변경하면 됩니다.</p>\n<h2 id=\"더-알아보기\" style=\"position:relative;\">더 알아보기<a href=\"#%EB%8D%94-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0\" aria-label=\"더 알아보기 permalink\" class=\"anchor after\"><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" width=\"1rem\" stroke-width=\"1.5\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244\" /></svg></a></h2>\n<ul>\n<li>instanceof의 동작 원리\n<ul>\n<li><code class=\"language-text\">instanceof</code> 연산자는 <code class=\"language-text\">object</code>의 프로토타입 체인에 <code class=\"language-text\">constructor.prototype</code>이 존재하는지 판별합니다.</li>\n<li>직접 구현한 instanceof</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">isInstanceof</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">object<span class=\"token punctuation\">,</span> constructor</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>object <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t  <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n\t<span class=\"token keyword\">const</span> prototype <span class=\"token operator\">=</span> constructor<span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> proto <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">getPrototypeOf</span><span class=\"token punctuation\">(</span>object<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>proto <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>proto <span class=\"token operator\">===</span> prototype<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    proto <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">getPrototypeOf</span><span class=\"token punctuation\">(</span>proto<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n</ul>\n<h2 id=\"Reference\" style=\"position:relative;\">Reference<a href=\"#Reference\" aria-label=\"Reference permalink\" class=\"anchor after\"><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" width=\"1rem\" stroke-width=\"1.5\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244\" /></svg></a></h2>\n<ul>\n<li>해결법 (<a href=\"https://github.com/jsdom/jsdom/issues/2740#issuecomment-629792008\">https://github.com/jsdom/jsdom/issues/2740#issuecomment-629792008</a>)</li>\n<li>instanceof (<a href=\"https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Operators/instanceof\">https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Operators/instanceof</a>)</li>\n</ul>"},"prev":null,"next":{"frontmatter":{"slug":"trigger-transition","title":"transition이 발생하지 않는 이유"}}},"pageContext":{"id":"750e6519-1c88-5346-9b6b-f79e4147f45c","prev":"","next":"1f8f61a7-0efd-52d2-b596-e57e3e081ac1"}},"staticQueryHashes":["1218423607"],"slicesMap":{}}